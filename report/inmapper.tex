\begin{algorithm}[H]
    \caption{Letter Count with In-Mapper Combiner}
    \begin{algorithmic}[1]
    \Require Txt file
    \Ensure Total count of each letter in the input file
    
    \Statex
    \noindent \textbf{CountMapper}
        \State \textbf{private map} $\leftarrow$ \{\}
        
        \State \textbf{private normalize}
    
        \Procedure{Setup}{Context context}
            \State \textbf{normalize} $\leftarrow$ context.getConfiguration().get("normalize")
        \EndProcedure
    
        \Procedure{Map}{Object key, Text value}
            \State line $\leftarrow$ Normalize(value.toString(), \textbf{normalize})
            \For{each character $c$ in line}
                \If{$c$ is a letter}
                    \If{\textbf{map} contains $c$}
                        \State \textbf{map}[$c$] $\leftarrow$ \textbf{map}[$c$] + 1
                    \Else
                        \State \textbf{map}[$c$] $\leftarrow$ 1
                    \EndIf
                \EndIf
            \EndFor
        \EndProcedure
    
        \Procedure{Cleanup}{Context context}
            \For{each entry $<k, v>$ in \textbf{map}}
                \State Emit($k$, $v$)
            \EndFor
        \EndProcedure
    
        \vspace{1em}

    \Statex
    \noindent \textbf{CountReducer}

    
        \Procedure{Reduce}{Text key, Iterable$<$LongWritable$>$ values}
            \State sum $\leftarrow$ 0
            \For{each value in values}
                \State sum $\leftarrow$ sum + value
            \EndFor
            \State Emit(key, sum)
        \EndProcedure

    \end{algorithmic}
    \end{algorithm}
    
    \begin{algorithm}[H]
    \caption{Letter Frequency with In-Mapper Combiner}
    \begin{algorithmic}[1]
    \Require Txt file, Total number of characters in the txt file
    \Ensure Frequency of each letter in the input file
    
    \vspace{1em}

    \Statex
    \noindent \textbf{CountMapper}
        \State \textbf{private map} $\leftarrow$ \{\}
        \State \textbf{private normalize}
    
        \Procedure{Setup}{Context context}
            \State \textbf{normalize} $\leftarrow$ context.getConfiguration().get("normalize")
        \EndProcedure
    
        \Procedure{Map}{Object key, Text value}
            \State line $\leftarrow$ Normalize(value.toString(), \textbf{normalize})
            \For{each character $c$ in line}
                \If{$c$ is a letter}
                    \If{\textbf{map} contains $c$}
                        \State \textbf{map}[$c$] $\leftarrow$ \textbf{map}[$c$] + 1
                    \Else
                        \State \textbf{map}[$c$] $\leftarrow$ 1
                    \EndIf
                \EndIf
            \EndFor
        \EndProcedure
    
        \Procedure{Cleanup}{Context context}
            \For{each entry $<k, v>$ in \textbf{map}}
                \State Emit($k$, $v$)
            \EndFor
        \EndProcedure
    
        \vspace{1em}

    \Statex
    \noindent \textbf{CountReducer}
        \State \textbf{private letterCount}
    
        \Procedure{Setup}{Context context}
            \State \textbf{letterCount} $\leftarrow$ context.getConfiguration().getLong("letterCountValue", 1)
        \EndProcedure
    
        \Procedure{Reduce}{Text key, Iterable$<$LongWritable$>$ values}
            \State sum $\leftarrow$ 0
            \For{each value in values}
                \State sum $\leftarrow$ sum + value
            \EndFor
            \State freq $\leftarrow$ (double) sum / (double) \textbf{letterCount}
            \State Emit(key, freq)
        \EndProcedure

    \end{algorithmic}
    \end{algorithm}
    